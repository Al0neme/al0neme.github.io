<!DOCTYPE html> <html lang=en style><!--
 Page saved with SingleFile 
 url: https://xz.aliyun.com/t/7683?time__1311=n4%2BxnD0G0%3DG%3De4Ywx05%2BbFYDtK0Q%3DkYDcjQ8YD&alichlgref=https%3A%2F%2Flink.zhihu.com%2F 
 saved date: Tue Feb 20 2024 22:14:42 GMT+0800 (中国标准时间)
--><meta charset=utf-8>
<title>Tomcat Ghostcat - AJP协议文件读取/文件包含漏洞（CVE-2020-1938 / CNVD-2020-10487） - 先知社区</title>
<meta name=description content=先知社区，先知安全技术社区>
<meta name=viewport content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<style>/*!
 * Bootstrap v2.3.1
 *
 * Copyright 2012 Twitter, Inc
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world @twitter by @mdo and @fat.
 */.clearfix:before,.clearfix:after{display:table;line-height:0;content:""}.clearfix:after{clear:both}footer{display:block}html{font-size:100%;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}a:focus{outline:thin dotted #333;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}a:hover,a:active{outline:0}img{height:auto;vertical-align:middle;border:0;-ms-interpolation-mode:bicubic}input{margin:0}button{-webkit-appearance:button}body{margin:0;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;line-height:20px;color:#333}a{text-decoration:none}a:hover,a:focus{color:#005580;text-decoration:underline}.row:before,.row:after{display:table;line-height:0;content:""}.row:after{clear:both}.container{width:940px}.span10{width:780px}[class*="span"].pull-right{float:right}.container{margin-right:auto;margin-left:auto}.container:before,.container:after{display:table;line-height:0;content:""}.container:after{clear:both}p{margin:0 0 10px}strong{font-weight:bold}.text-right{text-align:right}.text-center{text-align:center}h4,h5,h6{margin:10px 0;font-family:inherit;font-weight:bold;line-height:20px;color:inherit;text-rendering:optimizelegibility}h4{font-size:17.5px}ul{padding:0}hr{margin:20px 0;border:0;border-top:1px solid #eee;border-bottom:1px solid #fff}blockquote p{font-size:17.5px;font-weight:300;line-height:1.25}q:before,q:after,blockquote:before,blockquote:after{content:""}code,pre{color:#333;-webkit-border-radius:3px;-moz-border-radius:3px}code{color:#d14;white-space:nowrap;border:1px solid #e1e1e8}pre{display:block;margin:0 0 10px;white-space:pre-wrap;border:1px solid rgba(0,0,0,0.15);-webkit-border-radius:4px;-moz-border-radius:4px}input{font-weight:normal}input{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}input[type="text"]{display:inline-block;padding:4px 6px;margin-bottom:10px;font-size:14px;line-height:20px;vertical-align:middle;-webkit-border-radius:4px;-moz-border-radius:4px}input{width:206px}input[type="text"]{background-color:#fff;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);-webkit-transition:border linear .2s,box-shadow linear .2s;-moz-transition:border linear .2s,box-shadow linear .2s;-o-transition:border linear .2s,box-shadow linear .2s;transition:border linear .2s,box-shadow linear .2s}textarea:focus,input[type="text"]:focus,input[type="password"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="time"]:focus,input[type="week"]:focus,input[type="number"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="color"]:focus,.uneditable-input:focus{border-color:rgba(82,168,236,0.8);outline:0;outline:thin dotted \9;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(82,168,236,0.6);-moz-box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(82,168,236,0.6);box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(82,168,236,0.6)}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#999}input{margin-left:0}input:focus:invalid,textarea:focus:invalid,select:focus:invalid{color:#b94a48;border-color:#ee5f5b}input:focus:invalid:focus,textarea:focus:invalid:focus,select:focus:invalid:focus{border-color:#e9322d;-webkit-box-shadow:0 0 6px #f8b9b7;-moz-box-shadow:0 0 6px #f8b9b7;box-shadow:0 0 6px #f8b9b7}.fade{opacity:0;-webkit-transition:opacity .15s linear;-moz-transition:opacity .15s linear;-o-transition:opacity .15s linear}.collapse{position:relative;-webkit-transition:height .35s ease;-moz-transition:height .35s ease;-o-transition:height .35s ease;transition:height .35s ease}.btn{text-shadow:0 1px 1px rgba(255,255,255,0.75);vertical-align:middle;background-image:-moz-linear-gradient(top,#fff,#e6e6e6);background-image:-webkit-gradient(linear,0 0,0 100%,from(#fff),to(#e6e6e6));background-image:-webkit-linear-gradient(top,#fff,#e6e6e6);background-image:-o-linear-gradient(top,#fff,#e6e6e6);background-repeat:repeat-x;border:1px solid #ccc;border-bottom-color:#b3b3b3;-webkit-border-radius:4px;-moz-border-radius:4px;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,0.2),0 1px 2px rgba(0,0,0,0.05);-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,0.2),0 1px 2px rgba(0,0,0,0.05);box-shadow:inset 0 1px 0 rgba(255,255,255,0.2),0 1px 2px rgba(0,0,0,0.05)}.btn:hover,.btn:focus,.btn:active,.btn.active,.btn.disabled,.btn[disabled]{color:#333;background-color:#e6e6e6;*background-color:#d9d9d9}.btn:active,.btn.active{background-color:#ccc \9}.btn:first-child{*margin-left:0}.btn:hover,.btn:focus{color:#333;text-decoration:none;background-position:0-15px;-webkit-transition:background-position .1s linear;-moz-transition:background-position .1s linear;-o-transition:background-position .1s linear;transition:background-position .1s linear}.btn:focus{outline:thin dotted #333;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn.active,.btn:active{background-image:none;outline:0;-webkit-box-shadow:inset 0 2px 4px rgba(0,0,0,0.15),0 1px 2px rgba(0,0,0,0.05);-moz-box-shadow:inset 0 2px 4px rgba(0,0,0,0.15),0 1px 2px rgba(0,0,0,0.05);box-shadow:inset 0 2px 4px rgba(0,0,0,0.15),0 1px 2px rgba(0,0,0,0.05)}.btn-primary{text-shadow:0-1px 0 rgba(0,0,0,0.25);background-image:-moz-linear-gradient(top,#08c,#04c);background-image:-webkit-gradient(linear,0 0,0 100%,from(#08c),to(#04c));background-image:-webkit-linear-gradient(top,#08c,#04c);background-image:-o-linear-gradient(top,#08c,#04c);background-repeat:repeat-x}.btn-primary:hover,.btn-primary:focus,.btn-primary:active,.btn-primary.active,.btn-primary.disabled,.btn-primary[disabled]{color:#fff;background-color:#04c;*background-color:#003bb3}.btn-primary:active,.btn-primary.active{background-color:#039 \9}.navbar{margin-bottom:20px;overflow:visible}.navbar-inner{background-color:#fafafa;background-image:-moz-linear-gradient(top,#fff,#f2f2f2);background-image:-webkit-gradient(linear,0 0,0 100%,from(#fff),to(#f2f2f2));background-image:-webkit-linear-gradient(top,#fff,#f2f2f2);background-image:-o-linear-gradient(top,#fff,#f2f2f2);background-image:linear-gradient(to bottom,#fff,#f2f2f2);background-repeat:repeat-x;border:1px solid #d4d4d4;-webkit-border-radius:4px;-moz-border-radius:4px;-webkit-box-shadow:0 1px 4px rgba(0,0,0,0.065);-moz-box-shadow:0 1px 4px rgba(0,0,0,0.065)}.navbar-inner:before,.navbar-inner:after{display:table;line-height:0;content:""}.navbar-inner:after{clear:both}.navbar .container{width:auto}.nav-collapse.collapse{height:auto;overflow:visible}.navbar .brand{float:left;font-size:20px;font-weight:200;color:#777;text-shadow:0 1px 0#fff}.navbar .brand:hover,.navbar .brand:focus{text-decoration:none}.breadcrumb{margin:0 0 20px;list-style:none;-webkit-border-radius:4px;-moz-border-radius:4px}.modal{position:fixed;left:50%;z-index:1050;width:560px;margin-left:-280px;background-color:#fff;border:1px solid rgba(0,0,0,0.3);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;outline:0;-webkit-box-shadow:0 3px 7px rgba(0,0,0,0.3);-moz-box-shadow:0 3px 7px rgba(0,0,0,0.3);box-shadow:0 3px 7px rgba(0,0,0,0.3);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box}.modal.fade{top:-25%;-webkit-transition:opacity .3s linear,top .3s ease-out;-moz-transition:opacity .3s linear,top .3s ease-out;-o-transition:opacity .3s linear,top .3s ease-out;transition:opacity .3s linear,top .3s ease-out}.modal-header{padding:9px 15px;border-bottom:1px solid #eee}.modal-body{position:relative;max-height:400px;padding:15px;overflow-y:auto}.modal-footer{padding:14px 15px 15px;margin-bottom:0;text-align:right;background-color:#f5f5f5;border-top:1px solid #ddd;-webkit-border-radius:0 0 6px 6px;-moz-border-radius:0 0 6px 6px;border-radius:0 0 6px 6px;-webkit-box-shadow:inset 0 1px 0#fff;-moz-box-shadow:inset 0 1px 0#fff;box-shadow:inset 0 1px 0#fff}.modal-footer:before,.modal-footer:after{display:table;line-height:0;content:""}.modal-footer:after{clear:both}.modal-footer .btn+.btn{margin-bottom:0;margin-left:5px}.label,.badge{white-space:nowrap;vertical-align:baseline}.label{-webkit-border-radius:3px;-moz-border-radius:3px}.badge{-webkit-border-radius:9px;-moz-border-radius:9px}.label:empty,.badge:empty{display:none}@-webkit-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@-moz-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@-ms-keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}@-o-keyframes progress-bar-stripes{from{background-position:0 0}to{background-position:40px 0}}@keyframes progress-bar-stripes{from{background-position:40px 0}to{background-position:0 0}}</style>
<style>/*! Editor.md v1.5.0 | editormd.min.css | Open source online markdown editor. | MIT License | By: Pandao | https://github.com/pandao/editor.md | 2015-06-09 *//*! prefixes.scss v0.1.0 | Author: Pandao | https://github.com/pandao/prefixes.scss | MIT license | Copyright (c) 2015 */.editormd-form br,.markdown-body hr:after{clear:both}@media only screen and (-webkit-min-device-pixel-ratio:2),only screen and (min-device-pixel-ratio:2){}@media only screen and (-webkit-min-device-pixel-ratio:3),only screen and (min-device-pixel-ratio:3){}/*! prefixes.scss v0.1.0 | Author: Pandao | https://github.com/pandao/prefixes.scss | MIT license | Copyright (c) 2015 *//*!
 *  Font Awesome 4.3.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}/*! prefixes.scss v0.1.0 | Author: Pandao | https://github.com/pandao/prefixes.scss | MIT license | Copyright (c) 2015 */.markdown-body hr:after,.markdown-body hr:before{content:"";display:table}/*! github-markdown-css | The MIT License (MIT) | Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com) | https://github.com/sindresorhus/github-markdown-css */.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;overflow:hidden}.markdown-body hr{-moz-box-sizing:content-box}.markdown-body *{-moz-box-sizing:border-box}.markdown-body a:active,.markdown-body a:hover{outline:0;text-decoration:underline}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body img{-moz-box-sizing:border-box}.markdown-body code:after,.markdown-body code:before{letter-spacing:-.2em;content:" "}/*! Pretty printing styles. Used with prettify.js. */@media screen{}@media screen{}</style>
<style>/*!
 * Bootstrap Responsive v2.3.1
 *
 * Copyright 2012 Twitter, Inc
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world @twitter by @mdo and @fat.
 */.clearfix:before,.clearfix:after{display:table;line-height:0;content:""}.clearfix:after{clear:both}@-ms-viewport{width:device-width}@media (min-width:768px) and (max-width:979px){}@media (max-width:767px){}@media (min-width:1200px){.row{margin-left:-30px}.row:before,.row:after{display:table;line-height:0;content:""}.row:after{clear:both}[class*="span"]{float:left;min-height:1px;margin-left:30px}.container{width:1170px}.span10{width:970px}.span3{width:270px}input{margin-left:0}}@media (min-width:768px) and (max-width:979px){.row{margin-left:-20px}.row:before,.row:after{display:table;line-height:0;content:""}.row:after{clear:both}[class*="span"]{float:left;min-height:1px;margin-left:20px}.container{width:724px}.span10{width:600px}.span3{width:166px}input{margin-left:0}}@media (max-width:767px){body{padding-right:0px;padding-left:0px}.container{width:auto}.row{margin-left:0}[class*="span"]{display:block;float:none;width:100%;margin-left:0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.modal{position:fixed;right:20px;left:20px;width:auto;margin:0}.modal.fade{top:-100px}}@media (max-width:480px){.nav-collapse{-webkit-transform:translate3d(0,0,0)}.modal{top:10px;right:10px;left:10px}}@media (max-width:979px){body{padding-top:0}.navbar .container{width:auto;padding:0}.navbar .brand{padding-right:10px;padding-left:10px}.nav-collapse{clear:both}.nav-collapse.collapse{height:0;overflow:hidden}}@media (min-width:980px){.nav-collapse.collapse{height:auto!important;overflow:visible!important}}</style>
<style>li{line-height:26px}a:hover{text-decoration:none}.post-user-action>span{margin-right:10px;line-height:21px;border:none}.post-user-action .i-seprator{color:rgba(0,0,0,0.1);margin:0 2px}.navbar .brand{padding:0;height:50px;margin-left:0;display:inline-block!important;background-repeat:no-repeat;width:120px;background-size:207px 50px;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IuWbvuWxgl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCIKCSB2aWV3Qm94PSIwIDAgODAwLjQgMTMwLjQiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDgwMC40IDEzMC40OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6IzM3M0Q0MTt9Cjwvc3R5bGU+Cjx0aXRsZT7lhYjnn6XmioDmnK/npL7ljLo8L3RpdGxlPgo8Zz4KCTxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iMCwxMjEuNCAwLDI3LjMgNTYuMywyNy4zIAkiLz4KCTxwb2x5Z29uIGNsYXNzPSJzdDAiIHBvaW50cz0iODkuOSw4LjQgODkuOSwxMDIuNSAzMy41LDEwMi41IAkiLz4KPC9nPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTMwLjcsNTguNGMtMi4zLTEuNC00LjctMi45LTcuMi00LjVjNi02LjksMTAuNy0xNi4yLDE0LjEtMjcuOWw4LjMsMS43Yy0wLjcsMS42LTEuNiwzLjktMi44LDYuOQoJYy0wLjcsMi4zLTEuMywzLjktMS43LDQuOGgxNy41VjI0aDguM3YxNS41aDI5LjZWNDdoLTI5LjZ2MTUuMWgzNC43VjcwaC0yNi41djIxLjNjLTAuMiwzLjQsMS42LDUsNS41LDQuOGg3LjIKCWMzLjIsMC4yLDUuMy0xLjMsNi4yLTQuNWMwLjItMS40LDAuNS00LjEsMC43LTguM2MwLDAuNywwLjEtMC4xLDAuMy0yLjRsNy42LDIuOGMtMC4yLDQuMS0wLjcsNy45LTEuNCwxMS40CgljLTEuNiw2LTUuOCw4LjgtMTIuNyw4LjZoLTEwLjdjLTcuNiwwLjItMTEuMi0zLjItMTEtMTAuM1Y3MC4xaC0xNS44djMuMWMwLDE1LjQtOS4xLDI2LjQtMjcuMiwzM2MtMS40LTIuMS0zLTQuNi00LjgtNy42CglDMTM1LjEsOTQsMTQzLDg1LjQsMTQzLDcyLjhWNzBoLTIyLjd2LTcuOWgzOC41VjQ3aC0yMS4zQzEzNS41LDUxLjEsMTMzLjIsNTQuOSwxMzAuNyw1OC40eiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjEzLjIsNTQuNmMtMC41LTAuMi0xLjItMC43LTIuMS0xLjRjLTEuOC0xLjQtMy4yLTIuMy00LjEtMi44YzQuOC04LjksOC4xLTE3LjksMTAtMjYuOGw3LjYsMS40CgljLTAuNSwxLjgtMS4zLDQuNC0yLjQsNy42Yy0wLjIsMS4yLTAuNSwyLTAuNywyLjRoMjQuMXY3LjJoLTEyYzAsOC43LTAuMSwxNC45LTAuMywxOC42aDE0LjFWNjhoLTE0LjhjMCwyLjMtMC4yLDQuNS0wLjcsNi41CgljMS42LDEuNiwzLjgsNCw2LjUsNy4yYzQuNiw0LjgsOCw4LjYsMTAuMywxMS40bC01LjgsNS4yYy0wLjktMS4yLTIuMy0yLjgtNC4xLTQuOGMtMS44LTIuMy00LjgtNS44LTguOS0xMC43CgljLTIuNSw3LjgtOC40LDE1LjUtMTcuNSwyMy4xYy0yLjMtMi44LTQuMS00LjgtNS41LTYuMmMxMS4yLTguOSwxNy4zLTE5LjUsMTguMi0zMS43aC0xNy4ydi03LjJoMTcuNWMwLjItMy45LDAuMy0xMC4xLDAuMy0xOC42CgloLTYuOUMyMTcuMSw0Ni4zLDIxNS4zLDUwLjQsMjEzLjIsNTQuNnogTTI1MS40LDEwMi43VjMxLjloMzUuOHY3MC41aC04LjN2LTcuNmgtMTkuNnY3LjlDMjU5LjMsMTAyLjcsMjUxLjQsMTAyLjcsMjUxLjQsMTAyLjd6CgkgTTI1OS4zLDM5LjR2NDcuOGgxOS42VjM5LjRIMjU5LjN6Ii8+CjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0yOTcuMiw4MS4xYy0wLjItMC45LTAuNi0yLjMtMS00LjFjLTAuNy0xLjgtMS4yLTMuMi0xLjQtNC4xYzkuMi02LjIsMTYuNC0xNC4zLDIxLjctMjQuNGgtMTkuNnYtNi45aDI3LjV2Ny4yCgljLTIuNSw1LjUtNS40LDEwLjQtOC42LDE0Ljh2NDIuM2gtNy42VjcyLjFDMzA1LDc1LjEsMzAxLjQsNzguMSwyOTcuMiw4MS4xeiBNMzExLjcsNDAuNWMtMC4yLTAuNS0wLjYtMS4xLTEtMi4xCgljLTIuOC02LTQuNi05LjctNS41LTExLjRsNi45LTMuMWMwLjcsMS4yLDEuOCwzLjMsMy40LDYuNWMxLjYsMywyLjgsNS4yLDMuNCw2LjVMMzExLjcsNDAuNXogTTMyNi44LDgwLjcKCWMtMS42LTIuMS00LjctNS42LTkuMy0xMC43Yy0wLjItMC4yLTAuNS0wLjUtMC43LTAuN2w0LjgtNC41YzIuMSwxLjgsNC45LDQuNiw4LjYsOC4zYzEuMSwxLjIsMS45LDIsMi40LDIuNEwzMjYuOCw4MC43egoJIE0zMjguNSw1Ni42VjQ5aDE4LjZWMjQuM2g4LjN2MjQuOEgzNzV2Ny42aC0xOS42djM5LjJoMjIuNHY2LjloLTUzdi02LjloMjIuNFY1Ni42SDMyOC41eiIvPgo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzg5LjgsMTAxLjRWMjkuMUg0NjJ2Ny42aC02NC4zdjU3LjhoNjUuN3Y2LjlIMzg5Ljh6IE00NTAuMyw5MC40Yy02LjItNi42LTEyLjYtMTMtMTkuMy0xOC45CgljLTYsNS43LTEzLjQsMTIuMy0yMi40LDE5LjZjLTEuNC0xLjYtMy40LTMuOC02LjItNi41YzguMy01LjcsMTUuOC0xMiwyMi43LTE4LjljLTYuOS02LjQtMTMuOC0xMi43LTIwLjYtMTguOWw2LjItNS4yTDQzMSw2MC4yCgljNS41LTYuMiwxMC45LTEyLjgsMTYuMi0yMGw3LjIsNC41Yy01LjcsNy42LTExLjYsMTQuNC0xNy41LDIwLjZjNi45LDYuNywxMy42LDEzLDIwLjMsMTguOUw0NTAuMyw5MC40eiIvPgo8L3N2Zz4K)}.brand-box{position:absolute}.related-section{min-height:42px;padding:5px 0;margin-top:25px;border-top:1px solid #eee}.related-section>.related-box{margin-top:17px}.related-section>.related-box>span{display:inline-block;padding:3px}.related-section>.related-box>span:nth-child(1){width:47%}.related-section>.related-box>span:nth-child(2){border-left:1px solid #eee;padding-left:8px;float:right;width:46%}.related-box .related-label{padding:3px 4px;margin-right:3px}@media screen{.navbar{margin-bottom:12px;overflow:visible}}@media screen and (min-width:1950px){}@media screen and (min-width:1660px) and (max-width:1945px){}@media screen and (min-width:1350px) and (max-width:1659px){}@media screen and (min-width:1100px) and (max-width:1349px){}@media only screen and (max-width:1100px){}@media only screen and (min-width:768px){}@media only screen and (max-width:736px){.brand{margin:0 auto}.brand-box{left:15px}}@media screen and (min-width:768px) and (max-width:1219px){}@media only screen and (min-width:320px) and (max-width:374px){}@media only screen and (min-width:321px) and (max-width:413px){.brand-box{left:15px}}@media screen and (min-width:1220px){}</style>
<style>a{color:#778087}.topic-list p{margin:0 0 0 0}.topic-content{min-height:40px}.collapse form{position:relative;width:300px;float:right}div.search{padding:10px 0}.d1 input{height:20px;padding-left:18px;border:1px solid #ddd;border-radius:15px;outline:none;background:#ffffff;color:#9E9C9C;float:right}.vote{font-weight:normal;margin-left:6px}.topic-list{word-break:break-all;word-wrap:break-word}ul{margin:0 0 10px 0}/*!*border-bottom: solid #eee 1px;*!*/.user-info{padding:5px 0 5px 0}.topic-info a,.topic-info{padding-top:5px}.topic-info a:hover{text-decoration:solid}.reminder{min-height:200px;border:1px #ddd solid;border-radius:3px;line-height:200px;text-align:center}</style>
<style>body{background-color:#eee}img{max-width:100%}form{margin:0!important}a:focus{text-decoration:none}.markdown-body p>code{white-space:normal;word-break:break-all;border:none!important}.box ul,ol{margin-bottom:0px!important}.markdown-body ol{margin:0 0 24px 0!important}.box a:hover{text-decoration:none}.box-container>ul>li{list-style-type:none}#Wrapper .row.box{margin-left:0px}.navbar-inner{border-radius:0px;min-height:40px;padding-right:0px;padding-left:0px;outline:none;margin-bottom:0;list-style:none;z-index:1050;background:#fff;-webkit-box-shadow:0 1px 4px rgba(0,21,41,0.08);box-shadow:0 1px 4px rgba(0,21,41,0.08);line-height:46px;-webkit-transition:background .3s,width .2s;-o-transition:background .3s,width .2s;transition:background .3s,width .2s}.bs-docs-footer{text-align:left;color:#99979c;height:64px;background-color:#FFF;border-top:1px solid rgba(0,0,0,0.22);line-height:64px}.bs-docs-footer .links>a{display:inline-block;padding:0 12px;border-left:1px solid #e8e8e8;color:#8c8c8c;line-height:1}.bs-docs-footer .links>a:first-child{border-left:none}.box-container .user-info{margin-bottom:10px;background:#fff}.content-title{font-size:24px;color:#333;text-decoration:none;line-height:24px;text-shadow:0 1px 0#fff}.box-container{padding:20px}.container .offset{margin-top:0!important}.breadcrumb{padding:8px 10px 8px 15px;margin-bottom:10px;border-radius:0;color:#000;background-color:#fff}.breadcrumb>li{text-shadow:none!important;margin:2px 0px}.active{color:#555;text-shadow:none!important}.breadcrumb .active{color:#555;display:inline-block;text-shadow:none!important}.label,.badge{background-color:#f4f4f4;font-size:12px;line-height:12px;display:inline-block;padding:4px 4px 4px 4px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;text-decoration:none;text-shadow:none;font-weight:normal}.pull-right .badge{color:#fff!important;background:#aab0c6!important;padding-left:10px!important;padding-right:10px!important;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}.topic-info{color:#999!important;font-size:12px!important}.topic-info a{padding:0px;color:#555!important;font-size:12px!important}.notice>.info-body{padding:10px;line-height:2.1}.topic-info a:hover{color:#4d5256;text-decoration:underline}.topic-info .cell{padding-left:0!important;margin-left:0px;font-size:10px;font-weight:bold}.markdown-body img{max-width:90%!important;text-align:center;margin-left:auto;margin-right:auto;display:block;padding:10px 0px 10px 0px}.topic-info span{margin-left:0px;font-size:10px;color:rgba(0,0,0,0.45)}.btn{display:inline-block;padding:4px 12px;margin-bottom:0;font-size:14px;line-height:20px;background-color:#f4f4f4;color:#444;border-color:#ddd;font-family:"Helvetica Neue For Number",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Hiragino Sans GB","Microsoft YaHei","Helvetica Neue",Helvetica,Arial,sans-serif;-webkit-box-sizing:border-box;box-sizing:border-box;margin:0;list-style:none;font-weight:400;text-align:center;cursor:pointer;background-image:none;white-space:nowrap;border-radius:2px;height:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}.box{font-family:Monospaced Number,Chinese Quote,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:14px;line-height:1.5;color:rgba(0,0,0,0.65);-webkit-box-sizing:border-box;box-sizing:border-box;margin-top:0!important;margin-bottom:20px;padding:0;list-style:none;background:#fff;border-radius:2px;position:relative;-webkit-transition:all .3s;-o-transition:all .3s;transition:all .3s;-moz-box-shadow:0 1px 1px rgba(0,0,0,0.15);-webkit-box-shadow:0 1px 1px rgba(143,168,191,.35);box-shadow:0 1px 1px rgba(143,168,191,.35);border-bottom:1px solid #e2e2e9}.box .info-panel{padding:20px}.box .info-panel hr{margin:10px 0;border:0;border-top:1px solid #eee;border-bottom:1px solid #fff}.span10{float:left;min-height:1px}.span3{min-height:1px;margin-left:0!important;width:270px}#chart-header>.charts{cursor:pointer;padding:10px;width:40%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#chart-header>.charts:nth-child(1){margin-right:0.1%;width:40.9%;float:left}#chart-header>.charts:nth-child(2){float:right}#chart-header>.active{font-weight:500;border-bottom:3px solid #e2e2e9}#chart_body .info-body{padding:10px}.member{vertical-align:middle;padding:10px 15px}.member:nth-last-child(1){border-bottom:none}.chart-avatar{width:25px}.chart-name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.chart-name>.nickname{flex-grow:3;padding:4px 4px 4px 8px;word-break:break-all;line-height:14px;margin:0 5px 5px 0;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chart-name .num-box{align-self:baseline}.chart-name .badge{padding:4px 10px 4px 10px}#Wrapper .span10{margin-left:0px!important;max-width:960px}@media (min-width:1200px){.container{width:82%!important}}@media screen and (min-width:1500px){#Wrapper.container,.navbar .navbar-inner .container,.bs-docs-footer .container{max-width:1100px!important}#Wrapper .span10{max-width:810px!important}}@media screen and (min-width:980px) and (max-width:1499px){#Wrapper.container,.navbar .navbar-inner .container,.bs-docs-footer .container{max-width:1100px!important}#Wrapper .span10{max-width:74%!important}.span3{max-width:24.5%!important}}@media screen and (min-width:768px) and (max-width:979px){#Wrapper.container,.navbar .navbar-inner .container,.bs-docs-footer .container{width:90%!important}#Wrapper .span10{width:77%!important}#chart-header>.charts{width:36%!important}.nav-collapse{clear:none!important;height:auto!important;overflow:auto!important;float:right}.span3{max-width:22%!important}}@media screen and (max-width:767px){#Wrapper.container,.navbar .navbar-inner .container,.bs-docs-footer .container{width:100%!important}.topic-info .info-left,.topic-info .info-right{display:block}.topic-info .info-right{margin-top:10px}.topic-info span{margin-left:0px}#Wrapper .span3 div.box{display:none}#Wrapper .span3{width:100%!important}#Wrapper .span3 div.box{margin-bottom:10px}#Wrapper .span3 div.box img{width:100px}}@media screen and (max-width:419px){body{padding-left:0px!important;padding-right:0px!important}}.content-node{padding-left:5px}@media (max-width:979px){.content-node{display:none}.t-vote{display:none!important}}@media (max-width:376px){}.col-sm-4{position:relative;min-height:1px;padding-right:15px;padding-left:15px}@media (min-width:768px){.col-sm-4{float:left}.col-sm-4{width:33.33333333%}}@media (min-width:992px){}@media (min-width:1200px){}</style>
<style>/*! prefixes.scss v0.1.0 | Author: Pandao | https://github.com/pandao/prefixes.scss | MIT license | Copyright (c) 2015 */@media only screen and (-webkit-min-device-pixel-ratio:2),only screen and (min-device-pixel-ratio:2){}@media only screen and (-webkit-min-device-pixel-ratio:3),only screen and (min-device-pixel-ratio:3){}/*! prefixes.scss v0.1.0 | Author: Pandao | https://github.com/pandao/prefixes.scss | MIT license | Copyright (c) 2015 *//*!
 *  Font Awesome 4.3.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */.pull-right{float:right}.pull-left{float:left}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}/*! prefixes.scss v0.1.0 | Author: Pandao | https://github.com/pandao/prefixes.scss | MIT license | Copyright (c) 2015 *//*! github-markdown-css | The MIT License (MIT) | Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (sindresorhus.com) | https://github.com/sindresorhus/github-markdown-css */.markdown-body{color:#333;font-family:Monospaced Number,Chinese Quote,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Helvetica Neue,Helvetica,Arial,sans-serif;font-size:15px;line-height:24px;letter-spacing:.05em;word-wrap:break-word}.markdown-body a{background:transparent}.markdown-body a:active,.markdown-body a:hover{outline:0}.markdown-body strong{font-weight:bold}.markdown-body img{border:0}.markdown-body hr{-moz-box-sizing:content-box;box-sizing:content-box}.markdown-body pre{font-family:"Meiryo UI","YaHei Consolas Hybrid",Consolas,"Malgun Gothic","Segoe UI","Trebuchet MS",Helvetica,monospace,monospace}.markdown-body *{-moz-box-sizing:border-box;box-sizing:border-box}.markdown-body a{color:#4183c4;text-decoration:none}.markdown-body a:hover,.markdown-body a:active{text-decoration:underline}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border:0;border-bottom:1px solid #ddd}.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{display:table;clear:both;content:""}.markdown-body blockquote{margin:0}.markdown-body ol{padding:0}.markdown-body code{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body pre{font:12px Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body>*:first-child{margin-top:0!important}.markdown-body>*:last-child{margin-bottom:0!important}.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:1em;margin-bottom:16px;font-weight:bold;line-height:1.4}.markdown-body h4{font-size:18px}.markdown-body h5{font-size:1em}.markdown-body h6{font-size:1em;color:#777}.markdown-body p,.markdown-body blockquote,.markdown-body ol,.markdown-body pre{margin-top:0;margin-bottom:24px}.markdown-body ol{padding-left:2em}.markdown-body blockquote{padding:0 15px;color:#777;border-left:4px solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body img{max-width:100%;-moz-box-sizing:border-box;box-sizing:border-box}.markdown-body code{padding:0;padding-top:0.2em;padding-bottom:0.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,0.04);border-radius:3px}.markdown-body code:before,.markdown-body code:after{letter-spacing:-0.2em;content:" "}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{padding:16px;overflow:auto;font-size:85%;background-color:#f7f7f7;border-radius:3px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body pre{word-wrap:normal}/*! Pretty printing styles. Used with prettify.js. */@media screen{}.markdown-body .highlight pre{line-height:1.6}@media screen{}</style>
<style>.highlight .c{color:#8f5902;font-style:italic}.highlight .k{color:#204a87;font-weight:bold}.highlight .n{color:#000000}.highlight .o{color:#ce5c00;font-weight:bold}.highlight .c1{color:#8f5902;font-style:italic}.highlight .kc{color:#204a87;font-weight:bold}.highlight .kd{color:#204a87;font-weight:bold}.highlight .s{color:#4e9a06}.highlight .na{color:#c4a000}.highlight .nt{color:#204a87;font-weight:bold}.highlight .s1{color:#4e9a06}</style>
<style>@-webkit-keyframes a{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes a{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@media (max-width:800px){}</style>
<!--[if lte IE 8]>
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <![endif]-->
<!--[if !IE]> -->
<style>#waf_nc_block{position:fixed;width:100%;height:100%;top:0;bottom:0;left:0;z-index:99999}</style><style data-id=immersive-translate-input-injected-css>@-webkit-keyframes immersive-translate-loading-animation{from{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(359deg)}}@keyframes immersive-translate-loading-animation{from{transform:rotate(0deg)}to{transform:rotate(359deg)}}@keyframes immersiveTranslateShadowRolling{0%{box-shadow:0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0)}12%{box-shadow:100px 0 var(--loading-color),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0)}25%{box-shadow:110px 0 var(--loading-color),100px 0 var(--loading-color),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0)}36%{box-shadow:120px 0 var(--loading-color),110px 0 var(--loading-color),100px 0 var(--loading-color),0px 0 rgba(255,255,255,0)}50%{box-shadow:130px 0 var(--loading-color),120px 0 var(--loading-color),110px 0 var(--loading-color),100px 0 var(--loading-color)}62%{box-shadow:200px 0 rgba(255,255,255,0),130px 0 var(--loading-color),120px 0 var(--loading-color),110px 0 var(--loading-color)}75%{box-shadow:200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),130px 0 var(--loading-color),120px 0 var(--loading-color)}87%{box-shadow:200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),130px 0 var(--loading-color)}100%{box-shadow:200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0)}}@media (prefers-color-scheme:dark){}@media screen and (max-width:768px){}</style><meta name=referrer content=no-referrer><link rel=icon href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAADDUExURUxpcVVVVUNDVT5CTz1BUEBVVT1BUD1BTz5CTz5GT0BDUVVVVT5CTz5BUj1CTz5BT05OYj1CUD5GVUJCUj5CUD5BTz5BT0lJbT5CUEJCVT9DUUBHVT5CUD5CTz9CUD5BTz1BTz5CUEREUz5CUD5BUD5DTz5CUD5BT0BDUT5CTz1CUD5EUUBgYEBDUT5CUT1CTz1BUD5BUD9DUT1CT0REVT5BUENDUT1BUEBGUz1BUD9DT0FBUz1CTz5BTz1CUD1BUD1BT5JdbS4AAABAdFJOUwAJKr76DPbywR1MBuRO5fsNsyEfvdtKB4MbfiTa+FnegYwitbBXfPdYrt0pCEiL9XmsRdgeVhO8KI2KK45a2b/ePQx7AAAAwUlEQVQ4y4XTxw7CQAwE0A2E0BN67733Xv3/X4U0kYgimKxP9vgdfNhVildaBVfmpQGPaPD+7mjAW74g5q8Ewqd4QHy1T+JCm4IdsqswsEUUchhYHxCFhYENkpYw0MCFEZuCJYKuMDB1LzQZsPLehX/BCONEGCiWcWGKghKmlTAwwDA3GbByGArCQA39UBiYLfwX/gD3mdyEgSy6i8nAuIfuLAx00ByFgbaB5hT3VdUDmk8mfc0fa9Y1oKLZKyNo+QEJQV3gLnHrKwAAAABJRU5ErkJggg==" type=image/x-icon><style>.sf-hidden{display:none!important}</style><link rel=canonical href="https://xz.aliyun.com/t/7683?time__1311=n4%2BxnD0G0%3DG%3De4Ywx05%2BbFYDtK0Q%3DkYDcjQ8YD&amp;alichlgref=https%3A%2F%2Flink.zhihu.com%2F"><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body>
<div class="navbar navbar-default">
 <div class=navbar-inner>
 <div class=container style=text-align:center;position:relative>
 <!--[if lte IE 8]>
            <span style="display:inline-block;margin:0 auto;color:red;">为了更好的体验，请使用IE10及以上版本</span>
            <![endif]-->
 <div class=brand-box>
 <a class=brand href=https://xz.aliyun.com/tab/1></a>
 </div>
 
 <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F7683&amp;from_type=xianzhi" class="pull-right anonymous-user hh_loding sf-hidden">
 登录</a>
 
 <div class="nav-collapse collapse">
 <div class="search d1 text-right">
 <form action=/search>
 <input type=text placeholder=搜索 name=keyword value>
 </form>
 </div>
 </div>
 </div>
 </div>
</div>
<div id=Wrapper class=container>
 
 
 <div class=row2>
 <div class=span10>
 
 
 
 
 
 
<div class="row box content">
 
 <div class=box-container>
 <div class=main-topic>
 <div class="clearfix user-info topic-list">
 <p><span class=content-title>Tomcat Ghostcat - AJP协议文件读取/文件包含漏洞（CVE-2020-1938 / CNVD-2020-10487）</span>
 </p>
 <div class=topic-info>
 <span class=info-left>
 <a href=https://xz.aliyun.com/u/1874>
 <span class="username cell"> raul</span></a> <span class=i-seprator> / </span>
 <span> 2020-04-30 09:25:44</span><span class=i-seprator> / </span>
 
 <span>浏览数 18629</span>
 
 
 <span class=content-node>
 
 <span class="label label-default label-node-first">
 <a href=https://xz.aliyun.com/tab/4>社区板块</a></span>
 <span class="label label-default">
 <a href=https://xz.aliyun.com/node/1>漏洞分析</a></span>
 
 </span>
 </span>
 <span class="pull-right t-vote cell info-right"><a class="vote vote-up" href=javascript:void(0)>
 顶(2)</a>
 <a class="vote vote-down" href=javascript:void(0)>
 踩(0)</a></span>
 </div>
 </div>
 <hr>
 <div id=topic_content class="topic-content markdown-body">
 <h4>0x00 写在前面</h4>
<p>前几天仔细跟了下这个漏洞，学到了很多东西，尽量详细地对漏洞分析和相关基础知识做了记录。</p>
<p>相关知识点用最通俗易懂的方式进行描述，应该能清晰的明白漏洞原理。</p>
<p><strong>零基础慎入，因为一不小心你就看懂了。</strong></p>
<h4>0x01 环境搭建</h4>
<p>以tomcat 8.5.46版本为例进行漏洞分析，首先下载tomcat源码：<a href=http://archive.apache.org/dist/tomcat/tomcat-8/v8.5.46/src/apache-tomcat-8.5.46-src.zip%E3%80%82 target=_blank>http://archive.apache.org/dist/tomcat/tomcat-8/v8.5.46/src/apache-tomcat-8.5.46-src.zip。</a></p>
<p>搭建过程可以参考这篇Paper：<a href=https://blog.csdn.net/qq_35262405/article/details/101780644 target=_blank>Tomcat源码编译（IDEA）</a>，跟着这篇Paper一步一步搭建完成后，运行，随后浏览器访问<a href=http://127.0.0.1:8080会报500错误： target=_blank>http://127.0.0.1:8080会报500错误：</a></p>
<p><a id=img0 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125208-5a07e974-85e7-1.png><img src=data:,></a></p>
<p>解决办法是IDEA中找到<code>org.apache.catalina.startup.ContextConfig</code>，增加如下的一行代码，将JSP解析器初始化:</p>
<div class=highlight><pre><span></span><span class=n>context</span><span class=o>.</span><span class=na>addServletContainerInitializer</span><span class=o>(</span><span class=k>new</span> <span class=n>JasperInitializer</span><span class=o>(),</span> <span class=kc>null</span><span class=o>);</span>
</pre></div>
<p><a id=img1 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125232-68743d3c-85e7-1.png><img src=data:,></a></p>
<p>随后再次启动Tomcat，浏览器就能正常看到Tomcat的主页了。查看端口开放的开放情况，Tomcat运行开启了<strong>8009</strong>和<strong>8080</strong>端口。</p>
<h4>0x02 基础简介</h4>
<h5>(1) Tomcat Connector(连接器)</h5>
<p>首先来说一下Tomcat的Connector组件，Connector组件的主要职责就是负责<strong>接收客户端连接</strong>和<strong>客户端请求的处理加工</strong>。每个Connector会监听一个指定端口，分别负责对请求报文的解析和响应报文组装，解析过程封装Request对象，而组装过程封装Response对象。</p>
<p>举个例子，如果把Tomcat比作一个城堡，那么Connector组件就是城堡的城门，为进出城堡的人们提供通道。当然，可能有多个城门，每个城门代表不同的通道。而Tomcat默认配置启动，开了两个城门（通道）：一个是监听8080端口的<strong>HTTP Connector</strong>，另一个是监听8009端口的<strong>AJP Connector</strong>。</p>
<p>Tomcat组件相关的配置文件是在<code>conf/server.xml</code>，配置文件中每一个元素都对应了Tomcat的一个组件（可以在配置文件中找到如下两项，配置了两个Connector组件）：</p>
<div class=highlight><pre><span></span><span class=c>&lt;!-- Define a non-SSL/TLS HTTP/1.1 Connector on port 8080 --&gt;</span>
 <span class=nt>&lt;Connector</span> <span class=na>port=</span><span class=s>"8080"</span> <span class=na>protocol=</span><span class=s>"HTTP/1.1"</span> <span class=na>connectionTimeout=</span><span class=s>"20000"</span> <span class=na>redirectPort=</span><span class=s>"8443"</span> <span class=nt>/&gt;</span>
 .....
 <span class=c>&lt;!-- Define an AJP 1.3 Connector on port 8009 --&gt;</span>
 <span class=nt>&lt;Connector</span> <span class=na>port=</span><span class=s>"8009"</span> <span class=na>protocol=</span><span class=s>"AJP/1.3"</span> <span class=na>redirectPort=</span><span class=s>"8443"</span> <span class=nt>/&gt;</span>
</pre></div>
<p>HTTP Connector很好理解，通过浏览器访问Tomcat服务器的Web应用时，使用的就是这个连接器；</p>
<p>AJP Connector是通过AJP协议和一个Web容器进行交互。在将Tomcat与其他HTTP服务器（一般是Apache ）集成时，就需要用到这个连接器。AJP协议是采用二进制形式代替文本形式传输，相比HTTP这种纯文本的协议来说，效率和性能更高，也做了很多优化。</p>
<p>显然，浏览器只支持HTTP协议，并不能直接支持AJP协议。所以实际情况是，通过Apache的proxy_ajp模块进行反向代理，暴露成http协议（8009端口）给客户端访问，大致如下图所示：</p>
<p><a id=img2 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125300-79197d6e-85e7-1.png><img src=data:,></a></p>
<h5>(2) Servlet(服务程序)</h5>
<p>Servlet意为服务程序，也可简单理解为是一种用来处理网络请求的一套规范。主要作用是给上级容器(Tomcat)提供doGet()和doPost()等方法，其生命周期实例化、初始化、调用、销毁受控于Tomcat容器。有个例子可以很好理解：想象一下，在一栋大楼里有非常多特殊服务者Servlet，这栋大楼有一套智能系统帮助接待顾客引导他们去所需的服务提供者（Servlet）那接受服务。这里顾客就是一个个请求，特殊服务者就是Servlet，而这套智能系统就是Tomcat容器。</p>
<p>Tomcat中Servlet的配置是在<code>conf/web.xml</code>。Tomcat默认配置定义了两个servlet，分别为<code>DefaultServlet</code>和<code>JspServlet</code>：</p>
<div class=highlight><pre><span></span><span class=c>&lt;!-- The default servlet for all web applications, that serves static    --&gt;</span>
    <span class=c>&lt;!-- resources.  It processes all requests that are not mapped to other   --&gt;</span>
    <span class=c>&lt;!-- servlets with servlet mappings. --&gt;</span>
    <span class=nt>&lt;servlet&gt;</span>
        <span class=nt>&lt;servlet-name&gt;</span>default<span class=nt>&lt;/servlet-name&gt;</span>
        <span class=nt>&lt;servlet-class&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class=nt>&lt;/servlet-class&gt;</span>
        ......
        ......
    <span class=nt>&lt;/servlet&gt;</span>
    <span class=c>&lt;!-- The JSP page compiler and execution servlet, which is the mechanism  --&gt;</span>
    <span class=c>&lt;!-- used by Tomcat to support JSP pages.  Traditionally, this servlet    --&gt;</span>
    <span class=c>&lt;!-- is mapped to the URL pattern "*.jsp". --&gt;</span>
    <span class=nt>&lt;servlet&gt;</span>
        <span class=nt>&lt;servlet-name&gt;</span>jsp<span class=nt>&lt;/servlet-name&gt;</span>
        <span class=nt>&lt;servlet-class&gt;</span>org.apache.jasper.servlet.JspServlet<span class=nt>&lt;/servlet-class&gt;</span>
        ......
        ......
    <span class=nt>&lt;/servlet&gt;</span>
    ......
    ......
    <span class=c>&lt;!-- The mapping for the default servlet --&gt;</span>
    <span class=nt>&lt;servlet-mapping&gt;</span>
        <span class=nt>&lt;servlet-name&gt;</span>default<span class=nt>&lt;/servlet-name&gt;</span>
        <span class=nt>&lt;url-pattern&gt;</span>/<span class=nt>&lt;/url-pattern&gt;</span>
    <span class=nt>&lt;/servlet-mapping&gt;</span>

    <span class=c>&lt;!-- The mappings for the JSP servlet --&gt;</span>
    <span class=nt>&lt;servlet-mapping&gt;</span>
        <span class=nt>&lt;servlet-name&gt;</span>jsp<span class=nt>&lt;/servlet-name&gt;</span>
        <span class=nt>&lt;url-pattern&gt;</span>*.jsp<span class=nt>&lt;/url-pattern&gt;</span>
        <span class=nt>&lt;url-pattern&gt;</span>*.jspx<span class=nt>&lt;/url-pattern&gt;</span>
    <span class=nt>&lt;/servlet-mapping&gt;</span>
</pre></div>
<p>所有的请求进入tomcat，都会流经servlet。由注释可以很明显看出，如果没有匹配到任何应用指定的servlet，那么就会流到默认的servlet(即<code>DefaultServlet</code>)，而<code>JspServlet</code>负责处理所有JSP文件的请求。</p>
<h5>(3) Tomcat内部处理请求流程</h5>
<p>Tomcat内部处理请求的流程第一次看可能觉得会有点复杂。网上很多分析tomcat内部架构的文章，看几篇就能明白个大概了。网上看到张图，简单修改重新绘制了下，介绍一下Tomcat内部处理HTTP请求的流程，便于理解后续的漏洞分析：</p>
<p><a id=img3 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125414-a53ee2e4-85e7-1.png><img src=data:,></a></p>
<ol>
<li>用户点击网页内容，请求被发送到本机端口8080，被Connector获得（<strong>Connector中的Processor用于封装Request，Adapter用于将封装好的Request交给Container</strong>）。</li>
<li>Connector把该请求交给Container中的Engine来处理，并等待Engine的回应。</li>
<li>Engine获得请求localhost/test/index.jsp，匹配所有的虚拟主机Host。</li>
<li>Engine匹配到名为localhost的Host（即使匹配不到也把请求交给该Host处理，因为该Host被定义为该Engine的默认主机），名为localhost的Host获得请求/test/index.jsp，匹配它所拥有的所有的Context。Host匹配到路径为/test的Context（如果匹配不到就把该请求交给路径名为" "的Context去处理）。</li>
<li>path="/test"的Context获得请求/index.jsp，在它的mapping table中寻找出对应的Servlet。Context匹配到URL PATTERN为*.jsp的Servlet，对应于JspServlet类（<strong>匹配不到指定Servlet的请求对应DefaultServlet类</strong>）。</li>
<li>Wrapper是最底层的容器，负责管理一个Servlet。构造HttpServletRequest对象和HttpServletResponse对象，作为参数调用JspServlet的doGet()或doPost()，执行业务逻辑、数据存储等程序。</li>
<li>Context把执行完之后的HttpServletResponse对象返回给Host。</li>
<li>Host把HttpServletResponse对象返回给Engine。</li>
<li>Engine把HttpServletResponse对象返回Connector。</li>
<li>Connector把HttpServletResponse对象返回给客户Browser。</li>
</ol>
<h4>0x03 漏洞分析</h4>
<p>理解了上文的基础，下面开始分析漏洞。这个漏洞主要是通过AJP协议（8009端口）触发。正是由于上文所述，Ajp协议的请求在Tomcat内的处理流程与我们上文介绍的Tomcat处理HTTP请求流程类似。我们构造两个不同的请求，经过tomcat内部处理流程，一个走<code>default servlet</code>(DefaultServlet)，另一个走<code>jsp servlet</code>(JspServlet)，可导致的不同的漏洞。</p>
<p><strong>文件读取漏洞走的是DefaultServlet，文件包含漏洞走的是JspServlet。</strong></p>
<p>下面开始逐一进行分析，测试使用的POC如下：</p>
<p><a href=https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi target=_blank>https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi</a></p>
<h5>(1) 文件读取漏洞</h5>
<p>通过构造AJP协议请求，我们可以读取到 我们以读取<code>WEB-INF/web.xml</code>文件为例。</p>
<p>POC中赋值了四个很重要的参数，先在此说明：</p>
<div class=highlight><pre><span></span><span class=c1># 请求url</span>
<span class=n>req_uri</span> <span class=o>=</span> <span class=s1>'/asdf'</span>

<span class=c1># AJP协议请求中的三个属性</span>
<span class=n>javax</span><span class=o>.</span><span class=n>servlet</span><span class=o>.</span><span class=n>include</span><span class=o>.</span><span class=n>request_uri</span> <span class=o>=</span> <span class=s1>'/'</span>
<span class=n>javax</span><span class=o>.</span><span class=n>servlet</span><span class=o>.</span><span class=n>include</span><span class=o>.</span><span class=n>path_info</span> <span class=o>=</span> <span class=s1>'WEB-INF/web.xml'</span>
<span class=n>javax</span><span class=o>.</span><span class=n>servlet</span><span class=o>.</span><span class=n>include</span><span class=o>.</span><span class=n>servlet_path</span> <span class=o>=</span> <span class=s1>'/'</span>
</pre></div>
<h6>关键点1：<code>AjpProcessor类</code> -&gt; <code>service()</code> -&gt; <code>prepareRequest()</code></h6>
<p>根据上文的Tomcat处理请求流程，请求首先到达Connector，Connector内使用<code>AjpProcessor</code>解析Socket，将Socket中的内容封装到Request中。</p>
<p>所以我们首先将断点打到<code>AjpProcessor</code>类的<code>service()</code>方法：</p>
<p><a id=img4 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125523-ce4e9198-85e7-1.png><img src=data:,></a></p>
<p>一步步请求，随后跟入<code>prepareRequest()</code>方法。该方法解析请求，将相关属性匹配到该request的属性里。重点看这里：</p>
<p><a id=img5 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125602-e5c05a3c-85e7-1.png><img src=data:,></a></p>
<p>放到request对象中的三个参数和对应参数值如下：</p>
<p><a id=img6 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125649-01b11dbc-85e8-1.png><img src=data:,></a></p>
<p>随后将请求传给<code>CoyoteAdapter</code>，对request进行封装，将请求抓发给Container：</p>
<p><a id=img7 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125744-2262dbf4-85e8-1.png><img src=data:,></a></p>
<p>随后的Tomcat内部处理流程跳过，直接看Servlet中的处理，调用栈很清晰的展现了Tomcat内部处理的流程：</p>
<p><a id=img8 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125810-31f59070-85e8-1.png><img src=data:,></a></p>
<p>最后通过<code>ApplicationFilterChain</code>类的<code>internalDoFilter()</code>方法将流程走到Servlet。</p>
<p><a id=img9 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125851-4a2a7610-85e8-1.png><img src=data:,></a></p>
<h6>关键点2：<code>DefaultServlet类</code> -&gt; <code>service()</code> -&gt; <code>doGet()</code></h6>
<p>由上文介绍的<code>Servlet</code>相关基础知识可知，该请求是非JSP文件请求，匹配不到指定的servlet，所以会映射到默认的servlet(<code>default servlet</code>)处理。tomcat源码有个<code>DefaultServlet</code>类（路径：<code>org/apache/catalina/servlets/DefaultServlet.java</code>），我们断点也打到这个类，Debug看一下相关请求流程。</p>
<blockquote><p>这里还要科普一下<strong>Servlet如何处理请求</strong>：一般请求到达servlet后先执行<code>service()</code>方法，在方法中根据请求方式决定执行<code>doGet()</code>还是<code>doPost()</code>方法。</p>
</blockquote>
<p>流程进入<code>service()</code>方法，随后进入<code>doGet()</code>方法：</p>
<p><a id=img10 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424125917-59b5d89a-85e8-1.png><img src=data:,></a></p>
<h6>关键点3：<code>getRelativePath()</code></h6>
<p><code>doGet()</code>方法内直接进入<code>serveResource()</code>方法，我们直接看<code>serveResource()</code>方法：</p>
<p><a id=img11 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130132-aa8b02b8-85e8-1.png><img src=data:,></a></p>
<p>首先是进入<code>getRelativePath()</code>方法，该方法的作用是确认请求的资源路径，进入该方法，可以看到三个很重要的参数（红框）：</p>
<p><a id=img12 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130155-b854d860-85e8-1.png><img src=data:,></a></p>
<p>这三个参数所对应的值为：</p>
<div class=highlight><pre><span></span><span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>INCLUDE_REQUEST_URI</span> <span class=o>=</span> <span class=s>"javax.servlet.include.request_uri"</span><span class=o>;</span>
<span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>INCLUDE_PATH_INFO</span> <span class=o>=</span> <span class=s>"javax.servlet.include.path_info"</span><span class=o>;</span>
<span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>INCLUDE_SERVLET_PATH</span> <span class=o>=</span> <span class=s>"javax.servlet.include.servlet_path"</span><span class=o>;</span>
</pre></div>
<p>与我们的POC中的三个赋值参数对应，POC中的参数代入<code>getRelativePath()</code>方法，<code>RequestDispatcher.INCLUDE_REQUEST_URI</code>的值为'/'，不为空。pathInfo和servletPath参数的值拼接成result，<code>getRelativePath()</code>方法将result返回，返回内容为：'/WEB-INF/web.xml'。</p>
<h6>关键点4：<code>getResource()</code> -&gt; <code>validate()</code> -&gt; <code>normalize()</code></h6>
<p><code>serveResource()</code>方法继续往下，可以看到这行代码：</p>
<div class=highlight><pre><span></span><span class=c1>// path的值就是getRelativePath()方法的返回值：'/WEB-INF/web.xml'</span>
<span class=n>WebResource</span> <span class=n>resource</span> <span class=o>=</span> <span class=n>resources</span><span class=o>.</span><span class=na>getResource</span><span class=o>(</span><span class=n>path</span><span class=o>);</span>
</pre></div>
<p>跟入<code>getResource()</code>方法，可以看到调用了<code>validate()</code>方法。</p>
<p><a id=img13 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130235-cfe4794a-85e8-1.png><img src=data:,></a></p>
<p><code>validate()</code>方法内主要调用了<code>normalize()</code>方法对path参数进行校验。</p>
<div class=highlight><pre><span></span><span class=n>result</span> <span class=o>=</span> <span class=n>RequestUtil</span><span class=o>.</span><span class=na>normalize</span><span class=o>(</span><span class=n>path</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span>
</pre></div>
<p>我们直接看<code>normalize()</code>方法内做了那些校验：</p>
<p><a id=img14 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130300-deb36684-85e8-1.png><img src=data:,></a></p>
<p>返回null，回到<code>validate()</code>方法，就会报<strong>IllegalArgumentException(非法参数)</strong>的异常并终止本次操作。所以，<strong>我们的请求路径中不能包含"/../"，也就导致了该漏洞只能读取webapps目录下的文件</strong>。</p>
<p>经过<code>validate()</code>方法校验后，<code>getResources()</code>方法随后的一系列操作就通过路径读取到了资源。</p>
<h6>关键点5：<code>ServletOutputStream.write()</code></h6>
<p>最后通过<code>getOutputStream()</code>方法获得<code>ServletOutputStream</code>的实例：</p>
<p><a id=img15 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130327-eed4436c-85e8-1.png><img src=data:,></a></p>
<p>利用<code>ServletOutputStream.write()</code>向输出流写入返回内容。</p>
<p><a id=img16 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130351-fd352228-85e8-1.png><img src=data:,></a></p>
<p>随后再经过Tomcat内部流程处理，经过Tomcat的<code>Container</code>和<code>Connector</code>，最终返回给客户端。</p>
<h6><strong>关键点6：POC中的请求url(读取webapps下其他目录的文件)</strong></h6>
<p>前文提到POC中还有个关键参数<code>req_uri</code>，这个参数的设置决定了我们可以读取webapps下其他目录的文件。设置其值为一个随意字符串'asdf',一来是无法匹配到webapps下的路径，走tomcat默认的ROOT目录；二来是为了让tomcat将请求流到<code>DefaultServlet</code>，从而触发漏洞。当请求读取<code>WEB-INF/web.xml</code>文件，则读取的就是<code>webapps/ROOT/WEB-INF/</code>目录下的web.xml。</p>
<p>当读取<code>webapps/manager</code>目录下的文件，只需修改POC中<code>req_uri</code>参数为'manager/asdf'，读取<code>WEB-INF/web.xml</code>文件则是读取<code>webapps/manager/WEB-INF/</code>目录下的web.xml。</p>
<hr>
<p><strong>总结</strong>：至此，理解了如上6个关键点，整体漏洞流程也比较清晰了。</p>
<p><strong>漏洞复现：</strong>修改POC中的请求url为<code>/manager/asdf</code>，发送POC，读取到<code>webapps/manager/status.xsd</code>文件的内容（POC有做修改）：</p>
<p><a id=img17 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130423-100acf88-85e9-1.png><img src=data:,></a></p>
<h5>(2) 文件包含漏洞 （可致RCE）</h5>
<p>理解了上文的文件读取漏洞的分析，接下来的内容很好理解。与上文不同的是，请求经过<code>AjpProcessor</code>类的处理，随后将请求转发给了<code>JspServlet</code>（该原理上文也有介绍，POC中的请求url是.jsp文件，而<code>JspServlet</code>负责处理所有JSP文件的请求）。</p>
<p>首先在<code>webapps/manager</code>目录下新建文件test.txt，内容为：</p>
<div class=highlight><pre><span></span><span class=o>&lt;%</span><span class=n>Runtime</span><span class=o>.</span><span class=na>getRuntime</span><span class=o>().</span><span class=na>exec</span><span class=o>(</span><span class=s>"calc.exe"</span><span class=o>);%&gt;</span>
</pre></div>
<p>修改POC进行调试。POC中的四个关键参数，也先在此说明：</p>
<div class=highlight><pre><span></span><span class=c1># 请求url，这个参数一定要是以“.jsp”结尾</span>
<span class=n>req_uri</span> <span class=o>=</span> <span class=s1>'/manager/ddd.jsp'</span>

<span class=c1># AJP协议请求中的三个属性</span>
<span class=n>javax</span><span class=o>.</span><span class=n>servlet</span><span class=o>.</span><span class=n>include</span><span class=o>.</span><span class=n>request_uri</span> <span class=o>=</span> <span class=s1>'/'</span>
<span class=n>javax</span><span class=o>.</span><span class=n>servlet</span><span class=o>.</span><span class=n>include</span><span class=o>.</span><span class=n>path_info</span> <span class=o>=</span> <span class=s1>'test.txt'</span>
<span class=n>javax</span><span class=o>.</span><span class=n>servlet</span><span class=o>.</span><span class=n>include</span><span class=o>.</span><span class=n>servlet_path</span> <span class=o>=</span> <span class=s1>'/'</span>
</pre></div>
<h6>关键点1：<code>JspServlet类</code> -&gt; <code>service()</code> -&gt; <code>serviceJspFile()</code></h6>
<p>断点打到<code>JspServlet</code>类的<code>service()</code>方法，先将servlet_path和path_info拼接在一起，赋值给jspUri（故这个参数是可控的）。</p>
<p><a id=img18 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130456-243abfc2-85e9-1.png><img src=data:,></a></p>
<p>随后进入<code>serviceJspFile()</code>方法，将/test.txt带入Tomcat加载和处理jsp的流程里。具体处理流程就不描述了，根据网上的一张图做了些修改，大致画了下Tomcat加载和处理jsp的流程图，能很清晰的看懂处理流程：</p>
<p><a id=img19 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130519-31ca2902-85e9-1.png><img src=data:,></a></p>
<h6>关键点2：<code>JspServletWrapper类</code>：<code>getServlet()</code> -&gt; <code>service()</code></h6>
<p>最后返回到<code>JspServletWrapper</code>类，获取jsp编译后生成的servlet，随后调用service()方法，请求被执行。</p>
<p><a id=img20 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130539-3dc03800-85e9-1.png><img src=data:,></a></p>
<hr>
<p><strong>总结：</strong>简单理解就是我们传入的"/test.txt"被当成jsp编译执行。带入了Tomcat处理jsp的处理流程，将jsp(<code>test.txt</code>)转义成Servlet源代码.java(<code>test_txt.java</code>)，将Servlet源代码.java编译成Servlet类.class(<code>test_txt.class</code>)，Servlet类执行后，响应结果至客户端。</p>
<p><a id=img21 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130559-49a81f70-85e9-1.png><img src=data:,></a></p>
<p><strong>该漏洞造成RCE的条件是：在webapps目录下上传文件（可以是任意文件），随后通过该文件包含漏洞，造成RCE。</strong></p>
<p><strong>漏洞复现：</strong>修改poc中的请求url为<code>manager/ddd.jsp</code>，test.txt中的代码被执行。</p>
<p><a id=img22 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130624-581d4ddc-85e9-1.png><img src=data:,></a></p>
<h4>0x04 漏洞修复</h4>
<p>以官方发布的9.0.31版本的修复代码为例，主要做了以下修复：</p>
<p>1.<a href=https://github.com/apache/tomcat/commit/4c933d80e340b4a841a672060351b2190b326782 target=_blank>默认在<code>conf/server.xml</code>中禁用AJP连接器</a>；<br>
2.<a href=https://github.com/apache/tomcat/commit/0e8a50f0a5958744bea1fd6768c862e04d3b7e75 target=_blank>强制AJP协议默认监听本地环回地址，而不是0.0.0.0</a>；<br>
3.<a href=https://github.com/apache/tomcat/commit/9ac90532e9a7d239f90952edb229b07c80a9a3eb target=_blank>若使用AJP协议，设置secretRequired属性为true，强制配置secret来设置AJP协议认证凭证</a>；</p>
<p><a id=img23 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130706-719d63aa-85e9-1.png><img src=data:,></a></p>
<p>4.<a href=https://github.com/apache/tomcat/commit/64fa5b99442589ef0bf2a7fcd71ad2bc68b35fad target=_blank>配置属性白名单，若向AJP连接器发送任意未被识别的属性，都会响应403</a>;</p>
<p><a id=img24 href=https://xzfile.aliyuncs.com/media/upload/picture/20200424130723-7bd46e2c-85e9-1.png><img src=data:,></a></p>
<h4>0x05 参考文章</h4>
<ol>
<li><a href=https://blog.csdn.net/qq_36807862/article/details/81287955 target=_blank>Tomcat内核详解（六）：Connector组件</a>；</li>
<li><a href=https://blog.csdn.net/cx520forever/article/details/52743166 target=_blank>Tomcat整体架构浅析</a>；</li>
<li><a href=https://www.cnblogs.com/zhouyuqin/p/5143121.html target=_blank>解析Tomcat内部结构和请求过程</a>；</li>
<li><a href=https://paper.seebug.org/1142/ target=_blank>Apache Tomcat 远程文件包含漏洞深入分析 by <strong>天融信阿尔法实验室</strong></a>;</li>
<li><a href=https://xz.aliyun.com/t/7325 target=_blank>Tomcat Ajp协议文件包含漏洞分析 by <strong>d00ms</strong></a>;</li>
<li><a href=https://mp.weixin.qq.com/s/Y05EOzMhyztogNtL41MNNw target=_blank>CVE-2020-1938:Tomcat AJP文件包含漏洞分析 by <strong>c0ny1</strong></a>;</li>
<li><a href=https://paper.seebug.org/1147/ target=_blank>不调试源码重现 Ghostcat 漏洞 (CVE-2020-1938) by <strong>xax007</strong></a>;</li>
<li><a href=https://blog.trendmicro.com/trendlabs-security-intelligence/busting-ghostcat-an-analysis-of-the-apache-tomcat-vulnerability-cve-2020-1938-and-cnvd-2020-10487/ target=_blank>Busting Ghostcat: An Analysis of the Apache Tomcat Vulnerability (CVE-2020-1938 and CNVD-2020-10487) by <strong>趋势科技</strong></a>；</li>
</ol>
 </div>
 
 <div class=post-user-action style=margin-top:34px>
 <span class="btn btn-default pull-right" id=mark data-action=topic data-pk=7683>
 <span id=mark-text>点击收藏 </span><span class=i-seprator> | </span><span id=mark-count>5</span>
 </span>
 
 <span class="btn btn-default pull-right" id=follow_topic data-pk=7683>
 <span>关注</span><span class=i-seprator> | </span><span id=follow-count>3</span>
 </span>
 
 
 <span class="btn btn-default pull-right">
 <span>
 
 <span id=ready_reward data-toggle=modal data-target=#myModal>打赏</span>
 
 </span>
 </span>
 
 <div class=clearfix></div>
 </div>
 
 <div class=related-section>
 <div class=related-box>
 
 <span><a class=pull-left href=https://xz.aliyun.com/t/7654 title="Rand函数引发的安全问题 —— OSSN任意文件读取漏洞（CVE-2020-10560）"><span class=related-label style="padding:3px 4px;margin-right:3px">上一篇：</span>Rand函数引发的安全问题 —— ...</a></span>
 
 
 <span><a class=pull-left href=https://xz.aliyun.com/t/7685 title=从0到1对基于thinkphp的相关CTF题目分析><span class=related-label>下一篇：</span>从0到1对基于thinkphp的相...</a></span>
 
 </div>
 </div>
 
 </div>
 </div>
</div>
<div class="modal fade" id=myModal role=dialog aria-labelledby=myModalLabel aria-hidden=true>
 <div class=modal-dialog>
 <div class=modal-content>
 <div class=modal-header>
 <h4 class=modal-title id=myModalLabel style=text-align:center>
 积分打赏
 </h4>
 </div>
 <div class=modal-body id=button-value>
 <div style=text-align:center>
 <div role=group>
 <button type=button class="btn btn-secondary m64" style=min-width:64px data-value=type1>
 1分
 </button>
 <button type=button class="btn btn-secondary m64" style=min-width:64px data-value=type2>
 2分
 </button>
 <button type=button class="btn btn-secondary m64" style=min-width:64px data-value=type3>
 5分
 </button>
 </div>
 <br>
 <div style=margin-top:20px>
 <button type=button class="btn btn-secondary m64" style=min-width:64px data-value=type4>
 8分
 </button>
 <button type=button class="btn btn-secondary m64" style=min-width:64px data-value=type5>
 10分
 </button>
 <button type=button class="btn btn-secondary m64" style=min-width:64px data-value=type6>
 20分
 </button>
 </div>
 </div>
 </div>
 <div class=modal-footer id=confirm>
 <button type=button class="btn btn-default" data-dismiss=modal>关闭</button>
 <button type=button class="btn btn-primary" id=reward_topic data-pk=7683>确定</button>
 </div>
 </div>
 </div>
</div>
 
 
<div class="row box">
 <ol class=breadcrumb>
 <li class=active>0 条回复</li>
 </ol>
 <div class="box-container post-container">
 
 <ul>
 <li style=min-height:50px;line-height:60px;margin-left:15px><strong>动动手指，沙发就是你的了！</strong></li>
 </ul>
 
 </div>
</div>
 
 
 <div class="row box" id=reply-box>
 
 <div class="box-container clearfix">
 
 <div class=reminder>
 <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F7683&amp;from_type=xianzhi"><strong>登录</strong></a> 后跟帖
 </div>
 
 </div>
 </div>
 
 
 
 </div>
 <div class="span3 pull-right offset sidebar">
 
 <div class=box>
 <div class=info-panel>
 <p><strong>先知社区</strong></p>
 <hr>
 <p class="text-center login-btn">
 <a href="https://account.aliyun.com/login/login.htm?oauth_callback=https%3A%2F%2Fxz.aliyun.com%2Ft%2F7683&amp;from_type=xianzhi" class=btn>现在登录</a>
 </p>
 </div>
 </div>
 <div class=box>
 <div class="hot-node notice">
 <div class=info-body>
 <a href=https://xz.aliyun.com/notice style="padding:4px 10px 4px 10px">社区小黑板</a>
 </div>
 </div>
 </div>
 <div class=box>
 <div class="hot-node notice" style="padding:6px 10px 6px 10px">
 <strong>最新公告：</strong>
 <div class=info-body>
 <a href=https://xz.aliyun.com/t/13277 style="padding:4px 10px 4px 10px">
 新春贺礼，投稿狂欢！稿费累加+惊喜好礼等你来拿
 </a>
 <span style=float:right>
 2024-01-19
 </span>
 </div>
 </div>
 </div>
 <div class=box>
 <div class="hot-node notice" style="padding:6px 10px 6px 10px">
 <strong>月度热门：</strong>
 </div>
 <div class=info-body>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13502 title=AsyncRAT通信模型剖析及自动化解密脚本实现>
 AsyncRAT通信模型剖析及自动化解密脚本实现
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13505 title=AsyncRAT攻防技术对抗>
 AsyncRAT攻防技术对抗
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13596 title=QuasarRAT与AsyncRAT同源对比及分析>
 QuasarRAT与AsyncRAT同源对比及分析
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13689 title=针对FinGhost黑产组织攻击样本的详细分析>
 针对FinGhost黑产组织攻击样本的详细分析
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13690 title="初探小程序渗透--Sign 签名破解">
 初探小程序渗透--Sign 签名破解
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13525 title=深入学习Java代码审计技巧—详细剖析某erp漏洞>
 深入学习Java代码审计技巧—详细剖析某erp漏洞
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13592 title=探究域渗透下的四种票据>
 探究域渗透下的四种票据
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13642 title=针对某免杀CS样本的详细分析>
 针对某免杀CS样本的详细分析
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13556 title=PEB及其武器化>
 PEB及其武器化
 </a>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/t/13506 title=路由器通用0day漏洞挖掘及RCE思路>
 路由器通用0day漏洞挖掘及RCE思路
 </a>
 </div>
 </div>
 
 </div>
 </div>
<div class=box>
 <div class=global-charts>
 <div id=chart-header>
 <div class="col-sm-4 text-center charts" data-type=year>
 年度贡献榜
 </div>
 <div class="text-center charts active" data-type=month>
 月度贡献榜
 </div>
 <div class=clearfix></div>
 </div>
 <div id=chart_body>
 <div class="info-body sf-hidden" data-type=year>
 
 
 
 
 
 
 
 
 
 
 
 </div>
 <div class=info-body data-type=month>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/u/10995 title=Al1ex>Al1ex</a>
 <span class=num-box>
 <span class="badge badge-important">10</span>
 </span>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/u/3314 title=熊猫正正>熊猫正正</a>
 <span class=num-box>
 <span class="badge badge-important">9</span>
 </span>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/u/45703 title=你回来吗>你回来吗</a>
 <span class=num-box>
 <span class="badge badge-important">7</span>
 </span>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/u/46194 title=nihao123123>nihao123123</a>
 <span class=num-box>
 <span class="badge badge-important">6</span>
 </span>
 </div>
 </div>
 
 <div class=member>
 <div class="pull-left chart-avatar">
 
 <img src=data:,>
 
 </div>
 <div class=chart-name>
 <a class=nickname href=https://xz.aliyun.com/u/54020 title=AabyssZG>AabyssZG</a>
 <span class=num-box>
 <span class="badge badge-important">5</span>
 </span>
 </div>
 </div>
 
 </div>
 </div>
 </div>
</div>
 
 <div style=clear:both></div>
 
 
 </div>
 </div>
</div>
<footer class=bs-docs-footer>
 <div class="container text-center">
 <div class=links>
 <a href=https://xz.aliyun.com/feed target=_blank>RSS</a>
 <a href=https://xz.aliyun.com/about target=_blank><span>关于社区</span></a>
 <a href=https://xz.aliyun.com/partner target=_blank><span>友情链接</span></a>
 <a href=https://xz.aliyun.com/notice>社区小黑板</a>
 <a href=https://xz.aliyun.com/connection>联系我们</a>
 <a href=https://report.aliyun.com/ target=_blank>举报中心</a>
 <a href=https://www.aliyun.com/complaint target=_blank>我要投诉</a>
 </div>
 </div>
</footer>
 
 
 
<div id=waf_nc_block style=display:none></div>